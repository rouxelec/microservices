version: 0.2

phases:
  pre_build:
    commands:
      - echo Logging in to Amazon ECR...
      - aws --version
      - ALB_URL=$(aws ssm get-parameter --name "alb_url" | jq -r '.Parameter.Value')
      - QUERY_STRING="?target=lc"
      - LC_URL="$ALB_URL$QUERY_STRING"
      - echo $LC_URL
  build:
    commands:
      - echo Test started on `date`
      - pwd
      - chmod 777 src/codebuild/test.sh
      - src/codebuild/test_lambda_container.sh $LC_URL 
  post_build:
    commands:
      - echo Test completed on `date`